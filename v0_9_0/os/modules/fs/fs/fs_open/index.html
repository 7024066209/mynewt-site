<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <!-- This is broken by doc revisioning.
        <link rel="canonical" href="http://mynewt.apache.org/os/modules/fs/fs/fs_open/"> -->
        <link rel="shortcut icon" href="../../../../../img/favicon.ico">

	    <title>fs_open - Apache Mynewt</title>

        <link href="../../../../../css/bootstrap-3.0.3.min.css" rel="stylesheet">
        <link rel="stylesheet" href="../../../../../css/highlight.css">
        <link href="../../../../../css/base.css" rel="stylesheet">
        <link href="../../../../../css/custom.css" rel="stylesheet">
        <link href="../../../../../css/v2.css" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
        <link href="../../../../../extra.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
            <script>
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

                ga('create', 'UA-72162311-1', 'auto');
                ga('send', 'pageview');
            </script>
        
    </head>


    <body class="fs_open">


        <div class="container">
    <div class="row v2-main-banner">
        <a class="logo-cell" href="/">
            <img class="logo" src="/img/logo.png">
        </a>
        <div class="tagline-cell">
            <h4 class="tagline">An OS to build, deploy and securely manage billions of devices</h4>
        </div>
        <div class="news-cell">
            <div class="well">
                <h4>Latest News:</h4> <a href="/download">Apache Mynewt 1.0.0</a> released (March 22, 2017)
            </div>
        </div>
    </div>
</div>

        






<nav id="navbar" class="navbar navbar-inverse affix-top" data-spy="affix" data-offset-top="150" role="navigation">
    <div class="container">
        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav navbar-right">
                <li 
  class=""
>
                    <a href="/"><i class="fa fa-home" style="font-size: larger;"></i></a>
                </li>
                <li 
  class="important"
>
                    <a href="/quick-start/">Quick Start</a>
                </li>
                <li 
  class=""
>
                    <a href="/about/">About</a>
                </li>
                <li 
  class=""
>
                    <a href="/talks/">Talks</a>
                </li>
                <li 
  class="active"
>
                    <a href="/latest/os/introduction">Documentation</a>
                </li>
                <li 
  class=""
>
                    <a href="/download/">Download</a>
                </li>
                <li 
  class=""
>
                    <a href="/community/">Community</a>
                </li>
                <li 
  class=""
>
                    <a href="/events/">Events</a>
                </li>
            </ul>

        </div>
    </div>
</nav>

        

        <div class="container">
            
                <div class="row">
                    <div class="col-md-3 v2-sidebar sidebar-container"><div id="docSidebar" class="hidden-print" role="complementary">
    <div class="top">
        <div role="search">
            <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
                <div class="form-group">
                    <input type="text" name="q" class="form-control" placeholder="Search documentation" />
                </div>
            </form>
        </div>
    </div>
    <ul class="toc-nav">
      <li class="doc-version">
<select class="form-control" onchange="if (this.value) window.location.href=this.value">
    
    <option
      value="/develop/os/introduction"
      
    >
      Version: develop (latest)
    </option>
    
    <option
      value="/v0_9_0/os/introduction"
      selected="selected"
    >
      Version: 0.9.0
    </option>
    
    <option
      value="/v1_0_0/os/introduction"
      
    >
      Version: 1.0.0
    </option>
    
</select>
</li>
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
  
  
    <li ><a href="../../../../introduction/">Mynewt Documentation</a>
  
  
    <ul>
          
              
          
              
                
  
  
    <li ><a href="../../../../get_started/get_started/">Basic Setup</a>
  
  
    </li>

              
          
              
                
    <li >
      <a href="../../../../get_started/vocabulary/">Concepts</a>
    </li>

              
          
              
                
  
  
    <li ><a href="../../../../tutorials/tutorials/">Tutorials</a>
  
  
    </li>

              
          
              
                
  
  
    <li ><a href="../../../../os_user_guide/">OS User Guide</a>
  
  
    <ul>
          
              
          
              
                
  
  
    <li ><a href="../../../../core_os/mynewt_os/">OS Core</a>
  
  
    </li>

              
          
              
                
  
  
    <li ><a href="../../../../core_os/porting/port_os/">Porting to your Platform</a>
  
  
    </li>

              
          
              
                
  
  
    <li ><a href="../../../console/console/">Console</a>
  
  
    </li>

              
          
              
                
  
  
    <li ><a href="../../../shell/shell/">Shell</a>
  
  
    </li>

              
          
              
                
  
  
    <li ><a href="../../../bootloader/bootloader/">Bootloader</a>
  
  
    </li>

              
          
              
                
  
  
    <li><a href="
  
  
  ../fs/

">File System</a>
  
  
    <ul>
          
              
                
  
  
    <li ><a href="../fs/">File System Abstraction</a>
  
  
    <ul>
          
              
          
              
                
    <li >
      <a href="../fs_return_codes/">Return Codes</a>
    </li>

              
          
              
                
  
  
    <li><a href="
  ../fs_ops/
">Data Structures</a>
  
  
    </li>

              
          
              
                
  
  
    <li><a href="
  ../fs_close/
">Functions</a>
  
  
    <ul>
          
              
                
    <li >
      <a href="../fs_close/">fs_close</a>
    </li>

              
          
              
                
    <li >
      <a href="../fs_closedir/">fs_closedir</a>
    </li>

              
          
              
                
    <li >
      <a href="../fs_dirent_is_dir/">fs_dirent_is_dir</a>
    </li>

              
          
              
                
    <li >
      <a href="../fs_dirent_name/">fs_dirent_name</a>
    </li>

              
          
              
                
    <li >
      <a href="../fs_filelen/">fs_filelen</a>
    </li>

              
          
              
                
    <li >
      <a href="../fs_getpos/">fs_getpos</a>
    </li>

              
          
              
                
    <li >
      <a href="../fs_mkdir/">fs_mkdir</a>
    </li>

              
          
              
                
    <li class="active">
      <a href="./">fs_open</a>
    </li>

              
          
              
                
    <li >
      <a href="../fs_opendir/">fs_opendir</a>
    </li>

              
          
              
                
    <li >
      <a href="../fs_read/">fs_read</a>
    </li>

              
          
              
                
    <li >
      <a href="../fs_readdir/">fs_readdir</a>
    </li>

              
          
              
                
    <li >
      <a href="../fs_register/">fs_register</a>
    </li>

              
          
              
                
    <li >
      <a href="../fs_rename/">fs_rename</a>
    </li>

              
          
              
                
    <li >
      <a href="../fs_seek/">fs_seek</a>
    </li>

              
          
              
                
    <li >
      <a href="../fs_unlink/">fs_unlink</a>
    </li>

              
          
              
                
    <li >
      <a href="../fs_write/">fs_write</a>
    </li>

              
          
              
                
    <li >
      <a href="../fsutil_read_file/">fsutil_read_file</a>
    </li>

              
          
              
                
    <li >
      <a href="../fsutil_write_file/">fsutil_write_file</a>
    </li>

              
          
    </ul>
  
    </li>

              
          
    </ul>
  
    </li>

              
          
              
                
  
  
    <li ><a href="../../nffs/nffs/">Newtron Flash File System</a>
  
  
    </li>

              
          
              
                
    <li >
      <a href="../../otherfs/">Other File Systems</a>
    </li>

              
          
    </ul>
  
    </li>

              
          
              
                
  
  
    <li ><a href="../../../hal/hal/">Hardware Abstraction Layer</a>
  
  
    </li>

              
          
              
                
  
  
    <li ><a href="../../../testutil/testutil/">Test Utilities</a>
  
  
    </li>

              
          
              
                
  
  
    <li ><a href="../../../imgmgr/imgmgr/">Image Manager</a>
  
  
    </li>

              
          
              
                
    <li >
      <a href="../../../baselibc/">Baselibc library</a>
    </li>

              
          
              
                
  
  
    <li ><a href="../../../elua/elua/">Embedded Lua</a>
  
  
    </li>

              
          
              
                
  
  
    <li ><a href="../../../json/json/">JSON</a>
  
  
    </li>

              
          
              
                
  
  
    <li ><a href="../../../stats/stats/">Stats</a>
  
  
    </li>

              
          
              
                
  
  
    <li ><a href="../../../logs/logs/">Logs</a>
  
  
    </li>

              
          
    </ul>
  
    </li>

              
          
              
                
  
  
    <li><a href="
  ../../../../../network/ble/ble_intro/
">BLE User Guide</a>
  
  
    </li>

              
          
              
                
  
  
    <li ><a href="../../../../../newt/newt_intro/">Newt Tool Guide</a>
  
  
    </li>

              
          
              
                
  
  
    <li ><a href="../../../../../newtmgr/overview/">Newt Manager Guide</a>
  
  
    </li>

              
          
    </ul>
  
    </li>

        
      
        
          
  
  
    <li><a href="
  ../../../../../faq/how_to_edit_docs/
">Appendix</a>
  
  
    </li>

        
      
    </ul>
</div></div>

                    <div class="col-md-9" role="main">
                        <div class="doc-header">
                            <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="/v0_9_0/os/introduction">Docs</a></li>
    
    
        
          <li>&raquo; <a href="../fs/">File System Abstraction</a></li>
        
      
        
          <li>&raquo; <a href="../fs_close/">Functions</a></li>
        
      
      
        <li>&raquo; fs_open</li>
      
    
    
  </ul>
</div>
                        </div>
                        
                            <h2 id="fs95open"><font color="F2853F" style="font-size:24pt">fs_open</font></h2>
<pre class="codehilite"><code class="language-c">int fs_open(const char *filename, uint8_t access_flags,
            struct fs_file **out_file)</code></pre>


<p>Opens a file at the specified path.  The result of opening a nonexistent file depends on the access flags specified.  All intermediate directories must already exist.</p>
<p>The access flags are best understood by comparing them to their equivalent mode strings accepted by the C standard library function <code>fopen()</code>.
The mode strings passed to <code>fopen()</code> map to <code>fs_open()</code>'s access flags as follows:</p>
<pre class="codehilite"><code class="language-no-highlight">&quot;r&quot;  -  FS_ACCESS_READ
&quot;r+&quot; -  FS_ACCESS_READ  | FS_ACCESS_WRITE
&quot;w&quot;  -  FS_ACCESS_WRITE | FS_ACCESS_TRUNCATE
&quot;w+&quot; -  FS_ACCESS_READ  | FS_ACCESS_WRITE    | FS_ACCESS_TRUNCATE
&quot;a&quot;  -  FS_ACCESS_WRITE | FS_ACCESS_APPEND
&quot;a+&quot; -  FS_ACCESS_READ  | FS_ACCESS_WRITE    | FS_ACCESS_APPEND</code></pre>


<h4 id="arguments">Arguments</h4>
<table>
<thead>
<tr>
<th><em>Argument</em></th>
<th><em>Description</em></th>
</tr>
</thead>
<tbody>
<tr>
<td>filename</td>
<td>Null-terminated string indicating the full path of the file to open</td>
</tr>
<tr>
<td>access_flags</td>
<td>Flags controlling file access; see above table</td>
</tr>
<tr>
<td>out_file</td>
<td>On success, a pointer to the newly-created file handle gets written here</td>
</tr>
</tbody>
</table>
<h4 id="returned-values">Returned values</h4>
<ul>
<li>0 on success</li>
<li><a href="../fs_return_codes/">FS error code</a> on failure</li>
</ul>
<h4 id="notes">Notes</h4>
<ul>
<li>
<p>There is no concept of current working directory. Therefore all file names should start with '/'.</p>
</li>
<li>
<p>Always close files when you are done using them.  If you forget to close a file, the file stays open forever.  Do this too many times, and the underlying file system will run out of file handles, causing subsequent open operations to fail.  This type of bug is known as a file handle leak or a file descriptor leak.</p>
</li>
</ul>
<h4 id="header-file">Header file</h4>
<pre class="codehilite"><code class="language-c">#include &quot;fs/fs.h&quot;</code></pre>


<h4 id="example">Example</h4>
<p>The below code opens the file <code>/settings/config.txt</code> for reading, reads some data, and then closes the file.</p>
<pre class="codehilite"><code class="language-c">int
read_config(void)
{
    struct fs_file *file;
    uint32_t bytes_read;
    uint8_t buf[16];
    int rc;

    /* Open the file for reading. */
    rc = fs_open(&quot;/settings/config.txt&quot;, FS_ACCESS_READ, &amp;file);
    if (rc != 0) {
        return -1;
    }

    /* Read up to 16 bytes from the file. */
    rc = fs_read(file, sizeof buf, buf, &amp;bytes_read);
    if (rc == 0) {
        /* buf now contains up to 16 bytes of file data. */
        console_printf(&quot;read %u bytes\n&quot;, bytes_read)
    }

    /* Close the file. */
    fs_close(file);

    return rc == 0 ? 0 : -1;
}</code></pre>
                        
                        <div class="row">
                            



<ul class="nav nav-pills" style="margin-bottom: 10px">
    <li>
    
    <a href=../fs_mkdir/>
        <span class="fa fa-arrow-left"></span>
        Previous: fs_mkdir
    </a>
    
    </li>
    <li class="pull-right">
    
    <a href=../fs_opendir/>
        Next: fs_opendir
        <span class="fa fa-arrow-right"></span>
    </a>
    
    </li>
</ul>
                        </div>
                        <footer class="row">
    <div class="col-xs-12">
        
            <p class="copyright">Apache Mynewt (incubating) is available under Apache License, version 2.0.</p>
        
    </div>
    <div class="col-xs-12">
        <div class="logos">
            <img src="/img/asf_logo_wide_small.png" alt="Apache" title="Apache">
            <small class="footnote">
                MyNewt is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.
            </small>
            <img src="/img/egg-logo2.png" alt="Apache Incubator" title="Apache Incubator"><br/>
             <a href="https://join.slack.com/mynewt/shared_invite/MTkwMTg1ODM1NTg5LTE0OTYxNzQ4NzQtZTU1YmNhYjhkMg"><img src="https://www.countit.com/images/add_to_slack.png" alt="Slack Icon" title="Join our Slack Community" /></a>
        </div>
    </div>
</footer>
                    </div>
                </div>
            
            
        </div>

        <script src="../../../../../js/jquery-1.10.2.min.js"></script>
        <script src="../../../../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../../../../js/highlight.pack.js"></script>
        <script src="../../../../../js/base.js"></script>
        <script src="../../../../../js/custom.js"></script>

    </body>
</html>