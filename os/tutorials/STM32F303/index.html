<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="http://mynewt.apache.org/os/tutorials/STM32F303/">
        <link rel="shortcut icon" href="../../../img/favicon.ico">

	<title>Blinky on STM32F303 - Apache Mynewt</title>

        <link href="../../../css/bootstrap-3.0.3.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../../css/highlight.css">
        <link href="../../../css/base.css" rel="stylesheet">
        <link href="../../../css/custom.css" rel="stylesheet">
        <link href='https://fonts.googleapis.com/css?family=Roboto:400,500,700,900,300,100' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
        <link href="../../../extra.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
            <script>
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

                ga('create', 'UA-72162311-1', 'auto');
                ga('send', 'pageview');
            </script>
        
    </head>


    <body class="Blinky on STM32F303">


        <div id="navbar" class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="logo-container">
        <img src="/img/logo.svg">
    </div>
    <div class="container-fluid">
        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
                <li>
                    <a href="/about/">About</a>
                </li>
                <li class="dropdown">
                    <a href="/documentation/" class="dropdown-toggle" data-toggle="dropdown">Docs <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        
                        
                        
                        
                        <li >
                            <a href="../../../documentation/">
                                Overview
                            </a>
                        </li>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <li class="active">
                            <a href="../../get_started/introduction/">
                                Mynewt OS Manual
                            </a>
                        </li>
                        
                        
                        
                        <li >
                            <a href="../../../newt/newt_intro/">
                                Newt Tool Manual
                            </a>
                        </li>
                        
                        
                        
                        <li >
                            <a href="../../../newtmgr/overview/">
                                Newt Manager Manual
                            </a>
                        </li>
                        
                        
                        
                        <li >
                            <a href="../how_to_edit_docs/">
                                Appendix
                            </a>
                        </li>
                        
                        
                    </ul>
                </li>
                <li>
                    <a href="/download/">Download</a>
                </li>
                <li>
                    <a href="/community/">Community</a>
                </li>
                <li>
                    <a href="/events/">Events</a>
                </li>
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                
            </ul>
        </div>
    </div>
</div>

        

        <div class="container-fluid">
            
                <div class="row sm-extra-padding">
                    <div id="docSidebar" class="col-md-3 bg-grey sidebar-container"><div class="bs-sidebar hidden-print" role="complementary">
    <div class="sidebar-top">
        <img class="hidden-xs hidden-sm logo-small" src="/img/logo.svg" alt="MyNewt" title="MyNewt">
        <div class="small" role="search">
            <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
                <div class="form-group">
                    <input type="text" name="q" placeholder="Search documentation" />
                    <button class="search-button" type="submit"><i class="fa fa-search"></i></button>
                </div>
            </form>
        </div>
    </div>
    <ul class="nav bs-sidenav">
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
  
  
    <li><a href="
  ../../get_started/introduction/
">Mynewt OS Manual</a>
  
    
      <ul class="current-toc">
          
              
                
  
    <li>
      <a href="../../get_started/introduction/">Introduction</a>
    </li>
  

              
          
              
                
  
  
    <li ><a href="../../get_started/get_started/">Quick Start</a></li>
  
    
  </li>

              
          
              
                
  
  
    <li ><a href="../../get_started/vocabulary/">Concepts</a></li>
  
    
  </li>

              
          
              
                
  
  
    <li ><a href="../tutorials/">Tutorials</a></li>
  
    
      <ul class="current-toc">
          
              
          
              
                
  
    <li>
      <a href="../arduino_zero/">Blinky on Arduino Zero</a>
    </li>
  

              
          
              
                
  
    <li>
      <a href="../olimex/">Blinky on Olimex</a>
    </li>
  

              
          
              
                
  
    <li class="active">
      Blinky on STM32F303
    </li>
  

              
          
              
                
  
    <li>
      <a href="../nRF52/">Blinky on nRF52</a>
    </li>
  

              
          
              
                
  
    <li>
      <a href="../blinky_sram_olimex/">Run Blinky from SRAM, no bootloader</a>
    </li>
  

              
          
              
                
  
    <li>
      <a href="../add_repos/">Add repo to project</a>
    </li>
  

              
          
              
                
  
    <li>
      <a href="../create_repo/">Create a repo</a>
    </li>
  

              
          
              
                
  
    <li>
      <a href="../upgrade_repo/">Upgrade a repo</a>
    </li>
  

              
          
              
                
  
    <li>
      <a href="../bletiny_project/">Use BLE app to check stats via console</a>
    </li>
  

              
          
              
                
  
    <li>
      <a href="../project-slinky/">Enable remote comms on sim device</a>
    </li>
  

              
          
              
                
  
    <li>
      <a href="../project-target-slinky/">Enable remote comms on STM32 board</a>
    </li>
  

              
          
              
                
  
    <li>
      <a href="../unit_test/">Write a Test Suite for a Package</a>
    </li>
  

              
          
              
                
  
    <li>
      <a href="../air_quality_sensor/">Air-quality Sensor project</a>
    </li>
  

              
          
              
                
  
    <li>
      <a href="../event_queue/">Add task to manage multiple events</a>
    </li>
  

              
          
              
                
  
  
    <li ><a href="../bleprph/bleprph-intro/">BLE peripheral project</a></li>
  
    
  </li>

              
          
              
                
  
    <li>
      <a href="../ibeacon/">BLE iBeacon</a>
    </li>
  

              
          
      </ul>
    
  </li>

              
          
              
                
  
  
    <li ><a href="../../os_user_guide/">OS User Guide</a></li>
  
    
  </li>

              
          
              
                
  
  
    <li><a href="
  ../../../network/ble/ble_intro/
">BLE User Guide</a>
  
    
  </li>

              
          
      </ul>
    
  </li>

        
      
        
          
  
  
    <li><a href="
  ../../../newt/newt_intro/
">Newt Tool Manual</a>
  
    
  </li>

        
      
        
          
  
  
    <li><a href="
  ../../../newtmgr/overview/
">Newt Manager Manual</a>
  
    
  </li>

        
      
        
          
  
  
    <li><a href="
  ../how_to_edit_docs/
">Appendix</a>
  
    
  </li>

        
      
    </ul>
</div></div>

                    <div class="show-sidebar-container">
                        <button class="show-sidebar">Docs Menu</button>
                    </div>

                    <div class="col-md-offset-3 col-md-9 documentation-viewer" role="main">
                        <div class="row doc-header">
                            <div class="col-sm-6">
                                
<ul class="nav nav-pills">
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <li class="active" role="presentation"><a href="../../get_started/introduction/">Mynewt OS</a></li>
    
    
    
    <li  role="presentation"><a href="../../../newt/newt_intro/">Newt Tool</a></li>
    
    
    
    <li  role="presentation"><a href="../../../newtmgr/overview/">Newt Mgr</a></li>
    
    
    
    
</ul>
                            </div>
                            <div class="col-sm-6">
                                <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="/documentation/">Docs</a></li>
    
    
        
          <li>&raquo; <a href="../../get_started/introduction/">Mynewt OS Manual</a></li>
        
      
        
          <li>&raquo; <a href="../tutorials/">Tutorials</a></li>
        
      
      
        <li>&raquo; Blinky on STM32F303</li>
      
    
    
  </ul>
</div>
                            </div>
                        </div>
                        
                            <h2 id="blinky-your-hello-world-on-stm32f303-discovery">Blinky, your "Hello World!", on STM32F303 Discovery<a class="headerlink" href="#blinky-your-hello-world-on-stm32f303-discovery" title="Permanent link">&para;</a></h2>
<p><br></p>
<h3 id="objective">Objective<a class="headerlink" href="#objective" title="Permanent link">&para;</a></h3>
<p>Learn how to use packages from a default application repository of Mynewt to build your first <em>Hello World</em> application (Blinky) on a target board. Once built using the <em>newt</em> tool, this application will blink the LED lights on the target board.</p>
<p>Create a project with a simple app that blinks an LED on the stmf303 
discovery board.  In the process import some external libraries into your project. Download the application to the target and watch it blink!</p>
<p><br></p>
<h3 id="what-you-need">What you need<a class="headerlink" href="#what-you-need" title="Permanent link">&para;</a></h3>
<ul>
<li>Discovery kit with STM32F303VC MCU</li>
<li>Laptop running Mac OSX. </li>
<li>It is assumed you have already installed newt tool. </li>
<li>It is assumed you already installed native tools as described <a href="../../get_started/native_tools/">here</a></li>
</ul>
<p>Also, we assume that you're familiar with UNIX shells. Let's gets started!</p>
<p><br></p>
<h3 id="create-a-project">Create a project<a class="headerlink" href="#create-a-project" title="Permanent link">&para;</a></h3>
<p>Create a new project to hold your work.  For a deeper understanding, you can read about project creation in 
<a href="../../get_started/project_create/">Get Started -- Creating Your First Project</a>
or just follow the commands below.</p>
<p>If you've already created a project from another tutorial, you can re-use
that project.</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%">$ mkdir ~/dev
$ cd ~/dev
$ newt new myproj
Downloading project skeleton from apache/incubator-mynewt-blinky...
Installing skeleton in myproj...
Project myproj successfully created.

$ cd myproj
</pre></div>


<p><strong>Note:</strong> Don't forget to change into the <code>myproj</code> directory.</p>
<p><br></p>
<h3 id="import-external-stm32f3-library-support">Import External STM32F3 Library support<a class="headerlink" href="#import-external-stm32f3-library-support" title="Permanent link">&para;</a></h3>
<p>The STM32F303 support for Mynewt lives in an external repository.  It's
necessary to add another repository to the project.  To do this,
edit the file <code>project.yml</code> in the root directory of your project <code>myproj</code></p>
<p>This requires two changes to this file.</p>
<ol>
<li>You must define the properties of the external repository that you want
to add</li>
<li>You must include the repository in your project.</li>
</ol>
<p>Edit the file <code>project.yml</code> with your favorite editor and add the 
following repository details in the file (after the core 
repository).  This gives newt the information to contact the repository
and extract its contents.  In this case, the repository is on github in 
the <code>runtimeinc</code> collection. Its name is <code>mynewt-stm32f3</code> and we will accept
any version up to the latest. You can look at the contents <a href="https://github.com/runtimeinc/mynewt_stm32f3">here</a>.</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%">repository.mynewt_stm32f3:
    type: github
    vers: 0-latest
    user: runtimeinc
    repo: mynewt_stm32f3
</pre></div>


<p><br></p>
<p>In the same file, add the following highlighted line to the 
<code>project.repositories</code> variable.  This tells newt to download the
 repository contents into your project. </p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%">project.repositories:
    - apache-mynewt-core
<span style="background-color: #ffffcc">    - mynewt_stm32f3
</span></pre></div>


<p><br></p>
<h3 id="install-dependencies">Install dependencies<a class="headerlink" href="#install-dependencies" title="Permanent link">&para;</a></h3>
<p>Now you can install this into the project using:</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%">$ newt install -v 
Downloading repository description for apache-mynewt-core... success!
...
apache-mynewt-core successfully installed version 0.7.9-none
...
Downloading repository description for mynewt_stm32f3... success!
Downloading repository mynewt_stm32f3 
...
Resolving deltas: 100% (65/65), done.
Checking connectivity... done.
mynewt_stm32f3 successfully installed version 0.0.0-none
</pre></div>


<p><br></p>
<h3 id="create-targets">Create  targets<a class="headerlink" href="#create-targets" title="Permanent link">&para;</a></h3>
<p>Create two targets to build using the stmf3 board support package and the 
app blinky example from mynewt.  The output of these commands are not
shown here for brevity. </p>
<p>The first target is the application image itself. The second
target is the bootloader which allows you to upgrade your mynewt 
applications. </p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%">$ newt target create stmf3_blinky
$ newt target set stmf3_blinky build_profile=optimized
$ newt target set stmf3_blinky bsp=@mynewt_stm32f3/hw/bsp/stm32f3discovery
$ newt target set stmf3_blinky app=apps/blinky

$ newt target create stmf3_boot
$ newt target set stmf3_boot app=@apache-mynewt-core/apps/boot
$ newt target set stmf3_boot bsp=@mynewt_stm32f3/hw/bsp/stm32f3discovery
$ newt target set stmf3_boot build_profile=optimized

$ newt target show

targets/stmf3_blinky
    app=apps/blinky
    bsp=@mynewt_stm32f3/hw/bsp/stm32f3discovery
    build_profile=optimized
targets/stmf3_boot
    app=apps/boot
    bsp=@mynewt_stm32f3/hw/bsp/stm32f3discovery
    build_profile=optimized
</pre></div>


<p><br></p>
<h3 id="build-the-target-executables">Build the target executables<a class="headerlink" href="#build-the-target-executables" title="Permanent link">&para;</a></h3>
<p>To build the images, use the <code>newt build</code> command below.</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%">$ newt build stmf3_blinky
   ...
Archiving stm32f3discovery.a
Linking blinky.elf
App successfully built: ~/dev/myproj/bin/stmf3_blinky/apps/blinky/blinky.elf

$ newt build stmf3_boot
Compiling log_shell.c
Archiving log.a
Linking boot.elf
App successfully built: ~/dev/myproj/bin/stmf3_boot/apps/boot/boot.elf
</pre></div>


<p><br></p>
<h3 id="sign-and-create-the-blinky-application-image">Sign and create the blinky application image<a class="headerlink" href="#sign-and-create-the-blinky-application-image" title="Permanent link">&para;</a></h3>
<p>You must sign and version your application image to download it using newt.  Use
the <code>newt create-image</code> command to perform this action. Here we assign this
image an arbitrary version <code>1.2.3</code>.</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%">$ newt create-image stmf3_blinky 1.2.3
App image succesfully generated: ~/dev/myproj/bin/stmf3_blinky/apps/blinky/blinky.img
Build manifest:~/dev/myproj/bin/stmf3_blinky/apps/blinky/manifest.json
</pre></div>


<p><br></p>
<h3 id="configure-the-hardware">Configure the hardware<a class="headerlink" href="#configure-the-hardware" title="Permanent link">&para;</a></h3>
<p>The STM32F3DISCOVERY board includes an ST-LINK/V2 embedded debug tool interface that will be used to program/debug the board. To program the MCU on the board, simply plug in the two jumpers on CN4, as shown in the picture in red. If you want to learn more about the board you will find the User Manual at <a href="http://www.st.com/st-web-ui/static/active/jp/resource/technical/document/user_manual/DM00063382.pdf">http://www.st.com/st-web-ui/static/active/jp/resource/technical/document/user_manual/DM00063382.pdf</a></p>
<ul>
<li><img alt="STMdiscovery" src="../pics/STM32f3discovery_connector.png" /></li>
</ul>
<p><br></p>
<h3 id="download-the-images">Download the Images<a class="headerlink" href="#download-the-images" title="Permanent link">&para;</a></h3>
<p>Use the <code>newt load</code> command to download the images to the target board.</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%">$ newt -v load stmf3_boot
$ newt -v load stmf3_blinky
</pre></div>


<p><br></p>
<h3 id="watch-the-led-blink">Watch the LED blink<a class="headerlink" href="#watch-the-led-blink" title="Permanent link">&para;</a></h3>
<p>Congratulations! You have built, downloaded, and run your first application using mynewt for the stm32f3 discovery board. One of the LEDs on the LED wheel should be blinking at 1 Hz.</p>
<p>We have more fun tutorials for you to get your hands dirty. Be bold and try other Blinky-like <a href="../nRF52/">tutorials</a> or try enabling additional functionality such as <a href="../project-target-slinky/">remote comms</a> on the current board.</p>
<p>If you see anything missing or want to send us feedback, please do so by signing up for appropriate mailing lists on our <a href="../../../community/">Community Page</a>.</p>
<p>Keep on hacking and blinking!</p>
                        
                        <div class="row">
                            



<ul class="nav nav-pills" style="margin-bottom: 10px">
    <li>
    
    <a href=../olimex/>
        <span class="fa fa-arrow-left"></span>
        Previous: Blinky on Olimex
    </a>
    
    </li>
    <li class="pull-right">
    
    <a href=../nRF52/>
        Next: Blinky on nRF52
        <span class="fa fa-arrow-right"></span>
    </a>
    
    </li>
</ul>
                        </div>
                        <div class="row">
                            <footer>
    <div class="row">
        <div class="col-md-12">
            
                <p class="copyright">Copyright &copy; 2015 The Apache Software Foundation, Licensed under the Apache License, Version 2.0 Apache and the Apache feather logo are trademarks of The Apache Software Foundation.<br>The Apache Software Foundation Apache Incubator</p>
            
        </div>
    </div>
    <div class="copyright-logos">
        <div class="row">
            <div class="col-xs-6 text-right">
                <img src="/img/apache-feather.png" alt="Apache" title="Apache">
            </div>
            <div class="col-xs-6 text-left">
                <img src="/img/apache-logo.png" alt="Apache Incubator" title="Apache Incubator">
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <small class="footnote">
                MyNewt is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.
            </small>
        </div>
    </div>
</footer>
                        </div>
                    </div>
                </div>
            
            
        </div>

        <script src="../../../js/jquery-1.10.2.min.js"></script>
        <script src="../../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../../js/highlight.pack.js"></script>
        <script src="../../../js/base.js"></script>
        <script src="../../../js/custom.js"></script>

    </body>
</html>