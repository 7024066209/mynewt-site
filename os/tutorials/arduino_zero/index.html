<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="http://mynewt.apache.org/os/tutorials/arduino_zero/">
        <link rel="shortcut icon" href="../../../img/favicon.ico">

	<title>Blinky on Arduino Zero - Apache Mynewt</title>

        <link href="../../../css/bootstrap-3.0.3.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../../css/highlight.css">
        <link href="../../../css/base.css" rel="stylesheet">
        <link href="../../../css/custom.css" rel="stylesheet">
        <link href='https://fonts.googleapis.com/css?family=Roboto:400,500,700,900,300,100' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
        <link href="../../../extra.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
            <script>
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

                ga('create', 'UA-72162311-1', 'mynewt.incubator.apache.org');
                ga('send', 'pageview');
            </script>
        
    </head>


    <body class="Blinky on Arduino Zero">


        <div id="navbar" class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="logo-container">
        <img src="/img/logo.svg">
    </div>
    <div class="container-fluid">
        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
                <li>
                    <a href="/about/">About</a>
                </li>
                <li class="dropdown">
                    <a href="/documentation/" class="dropdown-toggle" data-toggle="dropdown">Docs <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        
                        
                        
                        
                        <li >
                            <a href="../../../documentation/">
                                Overview
                            </a>
                        </li>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <li class="active">
                            <a href="../../get_started/introduction/">
                                Mynewt OS Manual
                            </a>
                        </li>
                        
                        
                        
                        <li >
                            <a href="../../../newt/newt_intro/">
                                Newt Tool Manual
                            </a>
                        </li>
                        
                        
                        
                        <li >
                            <a href="../../../newtmgr/overview/">
                                Newt Manager Manual
                            </a>
                        </li>
                        
                        
                        
                        <li >
                            <a href="../../../faq/answers/">
                                Appendix
                            </a>
                        </li>
                        
                        
                    </ul>
                </li>
                <li>
                    <a href="/download/">Download</a>
                </li>
                <li>
                    <a href="/community/">Community</a>
                </li>
                <li>
                    <a href="/events/">Events</a>
                </li>
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                
            </ul>
        </div>
    </div>
</div>

        

        <div class="container-fluid">
            
                <div class="row sm-extra-padding">
                    <div id="docSidebar" class="col-md-3 bg-grey sidebar-container"><div class="bs-sidebar hidden-print" role="complementary">
    <div class="sidebar-top">
        <img class="hidden-xs hidden-sm logo-small" src="/img/logo.svg" alt="MyNewt" title="MyNewt">
        <div class="small" role="search">
            <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
                <div class="form-group">
                    <input type="text" name="q" placeholder="Search documentation" />
                    <button class="search-button" type="submit"><i class="fa fa-search"></i></button>
                </div>
            </form>
        </div>
    </div>
    <ul class="nav bs-sidenav">
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
  
  
    <li><a href="
  ../../get_started/introduction/
">Mynewt OS Manual</a>
  
    
      <ul class="current-toc">
          
              
                
  
    <li>
      <a href="../../get_started/introduction/">Introduction</a>
    </li>
  

              
          
              
                
  
  
    <li><a href="
  ../../get_started/native_tools/
">Get Started</a>
  
    
  </li>

              
          
              
                
  
  
    <li ><a href="../../get_started/vocabulary/">Concepts</a></li>
  
    
  </li>

              
          
              
                
  
  
    <li><a href="
  ../olimex/
">Tutorials</a>
  
    
      <ul class="current-toc">
          
              
                
  
    <li>
      <a href="../olimex/">Blinky on Olimex</a>
    </li>
  

              
          
              
                
  
    <li>
      <a href="../STM32F303/">Blinky on STM32F303</a>
    </li>
  

              
          
              
                
  
    <li>
      <a href="../nRF52/">Blinky on nRF52</a>
    </li>
  

              
          
              
                
  
    <li class="active">
      Blinky on Arduino Zero
    </li>
  

              
          
              
                
  
    <li>
      <a href="../unit_test/">Unit Testing a Package</a>
    </li>
  

              
          
              
                
  
    <li>
      <a href="../air_quality_sensor/">Adding an air-quality sensor</a>
    </li>
  

              
          
              
                
  
    <li>
      <a href="../how_to_edit_docs/">Edit Docs</a>
    </li>
  

              
          
      </ul>
    
  </li>

              
          
              
                
  
  
    <li><a href="
  
  
  ../../core_os/mynewt_os/

">OS User Guide</a>
  
    
  </li>

              
          
              
                
  
  
    <li><a href="
  
  
  ../../../network/ble/ble_intro/

">Networking User Guide</a>
  
    
  </li>

              
          
      </ul>
    
  </li>

        
      
        
          
  
  
    <li><a href="
  ../../../newt/newt_intro/
">Newt Tool Manual</a>
  
    
  </li>

        
      
        
          
  
  
    <li><a href="
  ../../../newtmgr/overview/
">Newt Manager Manual</a>
  
    
  </li>

        
      
        
          
  
  
    <li><a href="
  ../../../faq/answers/
">Appendix</a>
  
    
  </li>

        
      
    </ul>
</div></div>

                    <div class="show-sidebar-container">
                        <button class="show-sidebar">Docs Menu</button>
                    </div>

                    <div class="col-md-offset-3 col-md-9 documentation-viewer" role="main">
                        <div class="row doc-header">
                            <div class="col-sm-6">
                                
<ul class="nav nav-pills">
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <li class="active" role="presentation"><a href="../../get_started/introduction/">Mynewt OS</a></li>
    
    
    
    <li  role="presentation"><a href="../../../newt/newt_intro/">Newt Tool</a></li>
    
    
    
    <li  role="presentation"><a href="../../../newtmgr/overview/">Newt Mgr</a></li>
    
    
    
    
</ul>
                            </div>
                            <div class="col-sm-6">
                                <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="/documentation/">Docs</a></li>
    
    
        
          <li>&raquo; <a href="../../get_started/introduction/">Mynewt OS Manual</a></li>
        
      
        
          <li>&raquo; <a href="../olimex/">Tutorials</a></li>
        
      
      
        <li>&raquo; Blinky on Arduino Zero</li>
      
    
    
  </ul>
</div>
                            </div>
                        </div>
                        
                            <h1 id="running-mynewt-on-arduino-zero">Running Mynewt on Arduino Zero<a class="headerlink" href="#running-mynewt-on-arduino-zero" title="Permanent link">&para;</a></h1>
<p>This tutorial describes how to run Mynewt OS on Arduino Zero.  </p>
<h2 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">&para;</a></h2>
<p>Before tackling this tutorial, it's best to read about Mynewt in the <a href="../../get_started/introduction">Introduction</a> section of this documentation.</p>
<h2 id="equipment">Equipment<a class="headerlink" href="#equipment" title="Permanent link">&para;</a></h2>
<p>You will need the following equipment</p>
<ul>
<li>An Arduino Zero board.  NOTE: There are many flavors of Arduino. Ensure that 
you have an Arduino Zero. See below for the verions of Arduino Zero that are
compatible with this tutorial</li>
<li>A computer that can connect to the Arduino Zero over USB</li>
<li>A USB cable (Type A to micro B) that can connect the computer to the Arduino</li>
<li>The Mynewt Release</li>
</ul>
<h2 id="arduino-boards">Arduino Boards<a class="headerlink" href="#arduino-boards" title="Permanent link">&para;</a></h2>
<p>This tutorial has been tested on the following two Arduino Zero boards.</p>
<p><img src="https://www.arduino.cc/en/uploads/Main/Zero_Usb_Ports.jpg" alt="Drawing" style="width: 400px;"/>
<img src="http://www.arduino.org//images/products/ArduinoZeroPro-flat-org.jpg" alt="Drawing" style="width: 330px;"/></p>
<h2 id="steps">Steps<a class="headerlink" href="#steps" title="Permanent link">&para;</a></h2>
<p>Follow these simple steps and your board will be blinking in no time!</p>
<h3 id="install-mynewt-and-newt">Install Mynewt and Newt<a class="headerlink" href="#install-mynewt-and-newt" title="Permanent link">&para;</a></h3>
<p>If you have not already done so, install Newt as shown in the <a href="../../../newt/tutorials/newt_mac/">Newt install tutorial</a> and cloned the Mynewt OS repository as shown in the <a href="../../get_started/project1/">Get Started tutorial for Blinky</a></p>
<h3 id="fetch-external-packages-for-atmel-samd21">Fetch External Packages for Atmel SAMD21<a class="headerlink" href="#fetch-external-packages-for-atmel-samd21" title="Permanent link">&para;</a></h3>
<p>Mynewt uses source code provided directly from the chip manufacturer for 
low level operations. This code is licensed only for Atmel parts, and 
cannot live in the Apache Mynewt repository. Fetch the package from 
the runtime github repository</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%">    $ newt app add-pkg-list mynewt_arduino https://github.com/runtimeinc/mynewt_arduino_zero.git
</pre></div>


<p>Once that completes, install the arduino_zero bsp package.</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%">    $ newt pkg install hw/bsp/arduino_zero
</pre></div>


<h3 id="create-your-bootloader-target">Create your bootloader Target<a class="headerlink" href="#create-your-bootloader-target" title="Permanent link">&para;</a></h3>
<p>You need to tell Newt what you want to build.  This is done by setting up a 
target. It's easy - simply cut and paste the entire definition below.  You may have already seen how to set up a target definition one attribute (variable) at a time or by importing the entire definition in one command in this 
<a href="../../../newt/tutorials/define_target/">Example</a> or in the <a href="../../../newt/command_list/newt_target/">Manual</a>.</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%">    <span style="color: #000000">$</span> <span style="color: #000000">newt</span> <span style="color: #000000">target</span> <span style="color: #000000">import</span> <span style="color: #000000">arduino_zero_bootloader</span>
    @<span style="color: #000000">target=arduino_zero_bootloader</span>
    <span style="color: #000000">name=arduino_zero_bootloader</span>
    <span style="color: #000000">project=boot</span>
    <span style="color: #000000">bsp=hw/bsp/arduino_zero</span>
    <span style="color: #000000">compiler=arm-none-eabi-m0</span>
    <span style="color: #000000">identities=arduino_zero_pro</span>
    <span style="color: #000000">vers=</span><span style="color: #1C01CE">0.0.1</span>
    <span style="color: #000000">arch=cortex_m0</span>
    <span style="color: #000000">compiler_def=optimized</span>
    @<span style="color: #000000">endtargets</span>
</pre></div>


<p>If your console blocks, you may need to do a <code>ctrl-D</code> to complete 
the import.</p>
<p><em>NOTE: The identity in the target configuration above is for the Arduino 
Zero Pro board.  The BSP requires an option to specify <code>arduino_zero</code> or 
<code>arduino_zero_pro</code> target identity.  Regardless of the board you chose, 
you can leave this identity alone for this tutorial. The BSP differences 
are minor and not relevant for this tutorial.</em></p>
<h3 id="create-your-image-target">Create Your Image Target<a class="headerlink" href="#create-your-image-target" title="Permanent link">&para;</a></h3>
<p>You need to tell Newt what you want to build.  This is done by setting up a 
target.   You may have already seen this target definition in this 
<a href="../../../newt/tutorials/define_target/">Example</a></p>
<p>For simplicity, you can just import this target.  Just cut and paste
this into your Linux or MAC terminal from the larva directory.</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%">    <span style="color: #000000">$</span> <span style="color: #000000">newt</span> <span style="color: #000000">target</span> <span style="color: #000000">import</span> <span style="color: #000000">arduino_zero_blinky</span> 
    <span style="color: #000000">@target=arduino_zero_blinky</span> 
    <span style="color: #000000">vers=</span><span style="color: #1C01CE">0.0.1</span> 
    <span style="color: #000000">arch=cortex_m0</span> 
    <span style="color: #000000">compiler_def=debug</span> 
    <span style="color: #000000">name=arduino_zero_blinky</span> 
    <span style="color: #000000">bsp=hw/bsp/arduino_zero</span> 
    <span style="color: #000000">compiler=arm-none-eabi-m0</span> 
    <span style="color: #000000">identities=arduino_zero_pro</span>
    <span style="color: #000000">project=blinky</span> 
    <span style="color: #000000">@endtargets</span>
</pre></div>


<p>If your console blocks, you may need to do a <code>ctrl-D</code> to complete 
the import.</p>
<p><em>NOTE: The identity in the target configuration above is for the Arduino 
Zero Pro board.  The BSP requires an option to specify <code>arduino_zero</code> or 
<code>arduino_zero_pro</code> target identity.  Regardless of the board you chose, 
you can leave this identity alone for this tutorial. The BSP differences 
are minor and not relevant for this tutorial.</em></p>
<h3 id="verify-your-targets">Verify Your Targets<a class="headerlink" href="#verify-your-targets" title="Permanent link">&para;</a></h3>
<p>Depending on your shell you may need to do a <code>Ctrl-D</code> to terminate the import
operation. </p>
<p>You can do a <code>newt target show</code> to see your results.</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%"><span style="color: #000000">arduino_zero_blinky</span>
    <span style="color: #000000">arch=cortex_m0</span>
    <span style="color: #000000">bsp=hw/bsp/arduino_zero</span>
    <span style="color: #000000">compiler=arm-none-eabi-m0</span>
    <span style="color: #000000">compiler_def=debug</span>
    <span style="color: #000000">name=arduino_zero_blinky</span>
    <span style="color: #000000">identities=arduino_zero</span>
    <span style="color: #000000">project=blinky</span>
    <span style="color: #000000">vers=</span><span style="color: #1C01CE">0.0.1</span>
<span style="color: #000000">arduino_zero_bootloader</span>
    <span style="color: #000000">arch=cortex_m0</span>
    <span style="color: #000000">bsp=hw/bsp/arduino_zero</span>
    <span style="color: #000000">compiler=arm-none-eabi-m0</span>
    <span style="color: #000000">compiler_def=optimized</span>
    <span style="color: #000000">name=arduino_zero_bootloader</span>
    <span style="color: #000000">identities=arduino_zero_pro</span>
    <span style="color: #000000">project=boot</span>
    <span style="color: #000000">vers=</span><span style="color: #1C01CE">0.0.1</span>
</pre></div>


<h3 id="build-the-bootloader">Build the Bootloader<a class="headerlink" href="#build-the-bootloader" title="Permanent link">&para;</a></h3>
<p>To Build the bootloader, use newt to do:</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%">    <span style="color: #000000">$</span> <span style="color: #000000">newt</span> <span style="color: #000000">target</span> <span style="color: #000000">build</span> <span style="color: #000000">arduino_zero_bootloader</span>
</pre></div>


<p>You should see lots of console output while newt is resolving dependencies
and compiling the source code.  After a minute, it should complete with 
the following text.</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%">    . . .
    <span style="color: #000000">Archiving</span> <span style="color: #000000">libarduino_zero</span>.<span style="color: #000000">a</span>
    <span style="color: #000000">Compiling</span> <span style="color: #000000">boot</span>.<span style="color: #000000">c</span>
    <span style="color: #000000">Building</span> <span style="color: #000000">project</span> <span style="color: #000000">boot</span>
    <span style="color: #000000">Linking</span> <span style="color: #000000">boot</span>.<span style="color: #000000">elf</span>
    <span style="color: #000000">Successfully</span> <span style="color: #000000">run!</span>
</pre></div>


<h3 id="connect-the-target">Connect the Target<a class="headerlink" href="#connect-the-target" title="Permanent link">&para;</a></h3>
<p>Connect your computer to the Arduino Zero (from now on we'll call this the 
target) with the Micro-USB cable through the Programming Port as shown below. 
Mynewt will download and debug the target through this port. You should see a 
little green LED come on. That means the board has power.</p>
<p>No external debugger is required.  The Arduino Zero comes with an internal
debugger that can be accessed by Mynewt.</p>
<p>A image below shows the Arduino Zero Programming Port.</p>
<p><img src="https://www.arduino.cc/en/uploads/Main/Zero_Usb_Ports.jpg" alt="Drawing" style="width: 400px;"/>
<img src="http://www.arduino.org//images/products/ArduinoZeroPro-flat-org.jpg" alt="Drawing" style="width: 330px;"/></p>
<h3 id="download-the-bootloader">Download the Bootloader<a class="headerlink" href="#download-the-bootloader" title="Permanent link">&para;</a></h3>
<p>Execute the command to download the bootloader. </p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%">    <span style="color: #000000">$</span> <span style="color: #000000">newt</span> <span style="color: #000000">target</span> <span style="color: #000000">download</span> <span style="color: #000000">arduino_zero_bootloader</span>
</pre></div>


<p>The newt tool should respond with. Then 10-15 seconds later it will return a 
prompt indicating success.</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%">    <span style="color: #000000">Downloading</span> <span style="color: #000000">with</span> ...<span style="color: #000000">/arduino_zero_download</span>.<span style="color: #000000">sh</span>
</pre></div>


<h3 id="build-the-target">Build the Target<a class="headerlink" href="#build-the-target" title="Permanent link">&para;</a></h3>
<p>To Build the target, use newt to do:</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%">    <span style="color: #000000">$</span> <span style="color: #000000">newt</span> <span style="color: #000000">target</span> <span style="color: #000000">build</span> <span style="color: #000000">arduino_zero_blinky</span>
</pre></div>


<p>You should see lots of console output while newt is resolving dependencies
and compiling the source code.  After a minute, it should complete with 
the following text.</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%">     <span style="color: #000000">Archiving</span> <span style="color: #000000">libarduino_zero</span>.<span style="color: #000000">a</span>
    <span style="color: #000000">Compiling</span> <span style="color: #000000">main</span>.<span style="color: #000000">c</span>
    <span style="color: #000000">Building</span> <span style="color: #000000">project</span> <span style="color: #000000">blinky</span>
    <span style="color: #000000">Linking</span> <span style="color: #000000">blinky</span>.<span style="color: #000000">elf</span>
    <span style="color: #000000">Successfully</span> <span style="color: #000000">run!</span>
</pre></div>


<h3 id="build-the-downloadable-image">Build the Downloadable Image<a class="headerlink" href="#build-the-downloadable-image" title="Permanent link">&para;</a></h3>
<p>This command attaches the image descriptor header with the specified version
number and prepares the image for download.</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%">    <span style="color: #000000">$</span> <span style="color: #000000">newt</span> <span style="color: #000000">target</span> <span style="color: #000000">create-image</span> <span style="color: #000000">arduino_zero_blinky</span> <span style="color: #1C01CE">1.2.3</span>
</pre></div>


<h3 id="download-the-image">Download the Image<a class="headerlink" href="#download-the-image" title="Permanent link">&para;</a></h3>
<p>Execute the command to download the image. </p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%">    <span style="color: #000000">$</span> <span style="color: #000000">newt</span> <span style="color: #000000">target</span> <span style="color: #000000">download</span> <span style="color: #000000">arduino_zero_blinky</span>
</pre></div>


<p>The newt tool should respond with the following message. Then 10-15 seconds later it will return a prompt indicating success.</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%">    <span style="color: #000000">Downloading</span> <span style="color: #000000">with</span> ...<span style="color: #000000">/arduino_zero_download</span>.<span style="color: #000000">sh</span>
</pre></div>


<h3 id="watch-the-led-blink">Watch the LED blink<a class="headerlink" href="#watch-the-led-blink" title="Permanent link">&para;</a></h3>
<p>Congratulations! You have created a Mynewt operating system running on the 
Arduino Zero. The LED right next to the power LED should be blinking. It is toggled by one task running on the Mynewt OS.   </p>
                        
                        <div class="row">
                            <footer>
    <div class="row">
        <div class="col-md-12">
            
                <p class="copyright">Copyright &copy; 2015 The Apache Software Foundation, Licensed under the Apache License, Version 2.0 Apache and the Apache feather logo are trademarks of The Apache Software Foundation.<br>The Apache Software Foundation Apache Incubator</p>
            
        </div>
    </div>
    <div class="copyright-logos">
        <div class="row">
            <div class="col-xs-6 text-right">
                <img src="/img/apache-feather.png" alt="Apache" title="Apache">
            </div>
            <div class="col-xs-6 text-left">
                <img src="/img/apache-logo.png" alt="Apache Incubator" title="Apache Incubator">
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <small class="footnote">
                MyNewt is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.
            </small>
        </div>
    </div>
</footer>
                        </div>
                    </div>
                </div>
            
            
        </div>

        <script src="../../../js/jquery-1.10.2.min.js"></script>
        <script src="../../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../../js/highlight.pack.js"></script>
        <script src="../../../js/base.js"></script>
        <script src="../../../js/custom.js"></script>

    </body>
</html>