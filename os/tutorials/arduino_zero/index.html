<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="http://mynewt.apache.org/os/tutorials/arduino_zero/">
        <link rel="shortcut icon" href="../../../img/favicon.ico">

	<title>Blinky on Arduino Zero - Apache Mynewt</title>

        <link href="../../../css/bootstrap-3.0.3.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../../css/highlight.css">
        <link href="../../../css/base.css" rel="stylesheet">
        <link href="../../../css/custom.css" rel="stylesheet">
        <link href='https://fonts.googleapis.com/css?family=Roboto:400,500,700,900,300,100' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
        <link href="../../../extra.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
            <script>
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

                ga('create', 'UA-72162311-1', 'mynewt.incubator.apache.org');
                ga('send', 'pageview');
            </script>
        
    </head>


    <body class="Blinky on Arduino Zero">


        <div id="navbar" class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="logo-container">
        <img src="/img/logo.svg">
    </div>
    <div class="container-fluid">
        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
                <li>
                    <a href="/about/">About</a>
                </li>
                <li class="dropdown">
                    <a href="/documentation/" class="dropdown-toggle" data-toggle="dropdown">Docs <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        
                        
                        
                        
                        <li >
                            <a href="../../../documentation/">
                                Overview
                            </a>
                        </li>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <li class="active">
                            <a href="../../get_started/introduction/">
                                Mynewt OS Manual
                            </a>
                        </li>
                        
                        
                        
                        <li >
                            <a href="../../../newt/newt_intro/">
                                Newt Tool Manual
                            </a>
                        </li>
                        
                        
                        
                        <li >
                            <a href="../../../newtmgr/overview/">
                                Newt Manager Manual
                            </a>
                        </li>
                        
                        
                        
                        <li >
                            <a href="../how_to_edit_docs/">
                                Appendix
                            </a>
                        </li>
                        
                        
                    </ul>
                </li>
                <li>
                    <a href="/download/">Download</a>
                </li>
                <li>
                    <a href="/community/">Community</a>
                </li>
                <li>
                    <a href="/events/">Events</a>
                </li>
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                
            </ul>
        </div>
    </div>
</div>

        

        <div class="container-fluid">
            
                <div class="row sm-extra-padding">
                    <div id="docSidebar" class="col-md-3 bg-grey sidebar-container"><div class="bs-sidebar hidden-print" role="complementary">
    <div class="sidebar-top">
        <img class="hidden-xs hidden-sm logo-small" src="/img/logo.svg" alt="MyNewt" title="MyNewt">
        <div class="small" role="search">
            <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
                <div class="form-group">
                    <input type="text" name="q" placeholder="Search documentation" />
                    <button class="search-button" type="submit"><i class="fa fa-search"></i></button>
                </div>
            </form>
        </div>
    </div>
    <ul class="nav bs-sidenav">
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
  
  
    <li><a href="
  ../../get_started/introduction/
">Mynewt OS Manual</a>
  
    
      <ul class="current-toc">
          
              
                
  
    <li>
      <a href="../../get_started/introduction/">Introduction</a>
    </li>
  

              
          
              
                
  
  
    <li ><a href="../../get_started/get_started/">Quick Start</a></li>
  
    
  </li>

              
          
              
                
  
  
    <li ><a href="../../get_started/vocabulary/">Concepts</a></li>
  
    
  </li>

              
          
              
                
  
  
    <li ><a href="../tutorials/">Tutorials</a></li>
  
    
      <ul class="current-toc">
          
              
          
              
                
  
    <li class="active">
      Blinky on Arduino Zero
    </li>
  

              
          
              
                
  
    <li>
      <a href="../olimex/">Blinky on Olimex</a>
    </li>
  

              
          
              
                
  
    <li>
      <a href="../STM32F303/">Blinky on STM32F303</a>
    </li>
  

              
          
              
                
  
    <li>
      <a href="../nRF52/">Blinky on nRF52</a>
    </li>
  

              
          
              
                
  
    <li>
      <a href="../unit_test/">Write a Test Suite for a Package</a>
    </li>
  

              
          
              
                
  
    <li>
      <a href="../air_quality_sensor/">Air-quality Sensor project</a>
    </li>
  

              
          
              
                
  
    <li>
      <a href="../add_repos/">Additional Repositories</a>
    </li>
  

              
          
              
                
  
    <li>
      <a href="../event_queue/">A task to manages multiple events</a>
    </li>
  

              
          
      </ul>
    
  </li>

              
          
              
                
  
  
    <li ><a href="../../os_user_guide/">OS User Guide</a></li>
  
    
  </li>

              
          
              
                
  
  
    <li><a href="
  
  
  ../../../network/ble/ble_intro/

">Networking User Guide</a>
  
    
  </li>

              
          
      </ul>
    
  </li>

        
      
        
          
  
  
    <li><a href="
  ../../../newt/newt_intro/
">Newt Tool Manual</a>
  
    
  </li>

        
      
        
          
  
  
    <li><a href="
  ../../../newtmgr/overview/
">Newt Manager Manual</a>
  
    
  </li>

        
      
        
          
  
  
    <li><a href="
  ../how_to_edit_docs/
">Appendix</a>
  
    
  </li>

        
      
    </ul>
</div></div>

                    <div class="show-sidebar-container">
                        <button class="show-sidebar">Docs Menu</button>
                    </div>

                    <div class="col-md-offset-3 col-md-9 documentation-viewer" role="main">
                        <div class="row doc-header">
                            <div class="col-sm-6">
                                
<ul class="nav nav-pills">
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <li class="active" role="presentation"><a href="../../get_started/introduction/">Mynewt OS</a></li>
    
    
    
    <li  role="presentation"><a href="../../../newt/newt_intro/">Newt Tool</a></li>
    
    
    
    <li  role="presentation"><a href="../../../newtmgr/overview/">Newt Mgr</a></li>
    
    
    
    
</ul>
                            </div>
                            <div class="col-sm-6">
                                <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="/documentation/">Docs</a></li>
    
    
        
          <li>&raquo; <a href="../../get_started/introduction/">Mynewt OS Manual</a></li>
        
      
        
          <li>&raquo; <a href="../tutorials/">Tutorials</a></li>
        
      
      
        <li>&raquo; Blinky on Arduino Zero</li>
      
    
    
  </ul>
</div>
                            </div>
                        </div>
                        
                            <h2 id="running-mynewt-on-arduino-zero">Running Mynewt on Arduino Zero<a class="headerlink" href="#running-mynewt-on-arduino-zero" title="Permanent link">&para;</a></h2>
<p>This tutorial describes how to run Mynewt OS on Arduino Zero.  </p>
<h3 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">&para;</a></h3>
<p>Before tackling this tutorial, it's best to read about Mynewt in the <a href="../../get_started/introduction">Introduction</a> section of this documentation.</p>
<h3 id="equipment">Equipment<a class="headerlink" href="#equipment" title="Permanent link">&para;</a></h3>
<p>You will need the following equipment</p>
<ul>
<li>An Arduino Zero board.  NOTE: There are many flavors of Arduino. Ensure that 
you have an Arduino Zero. See below for the verions of Arduino Zero that are
compatible with this tutorial</li>
<li>A computer that can connect to the Arduino Zero over USB</li>
<li>A USB cable (Type A to micro B) that can connect the computer to the Arduino</li>
<li>The Mynewt Release</li>
</ul>
<h3 id="arduino-boards">Arduino Boards<a class="headerlink" href="#arduino-boards" title="Permanent link">&para;</a></h3>
<p>This tutorial has been tested on the following two Arduino Zero boards.</p>
<p><img src="https://www.arduino.cc/en/uploads/Main/Zero_Usb_Ports.jpg" alt="Drawing" style="width: 400px;"/>
<img src="http://www.arduino.org//images/products/ArduinoZeroPro-flat-org.jpg" alt="Drawing" style="width: 330px;"/></p>
<h3 id="steps">Steps<a class="headerlink" href="#steps" title="Permanent link">&para;</a></h3>
<p>Follow these simple steps and your board will be blinking in no time!</p>
<h4 id="install-mynewt-and-newt">Install Mynewt and Newt<a class="headerlink" href="#install-mynewt-and-newt" title="Permanent link">&para;</a></h4>
<p>If you have not already done so, install Newt as shown in the <a href="../../../newt/install/newt_mac/">Newt install tutorial</a> and cloned the Mynewt OS repository as shown in the <a href="../../get_started/project_create/">Get Started tutorial for Sim Blinky</a></p>
<h3 id="fetch-external-packages-for-atmel-samd21">Fetch External Packages for Atmel SAMD21<a class="headerlink" href="#fetch-external-packages-for-atmel-samd21" title="Permanent link">&para;</a></h3>
<p>Mynewt uses source code provided directly from the chip manufacturer for 
low level operations. This code is licensed only for Atmel parts, and 
cannot live in the Apache Mynewt repository. Fetch the package from 
the runtime github repository.</p>
<p>To fetch the package from the runtime git repository, you need to add 
the repository to the <code>project.yml</code> file in your base project directory.</p>
<p>Here is an example <code>project.yml</code> file with the Arduino Zero repository
added:</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%">$ more project.yml 
project.name: &quot;my_project&quot;

project.repositories:
    - apache-mynewt-core
    - mynewt_arduino_zero

repository.apache-mynewt-core:
    type: github
    vers: 0-latest
    user: apache
    repo: incubator-mynewt-core

repository.mynewt_arduino_zero:
    type: github
    vers: 0-latest
    user: runtimeinc
    repo: mynewt_arduino_zero
$ 
</pre></div>


<p>In the above, the sections with <code>mynewt_arduino_zero</code> need to be added to 
your project file.</p>
<p>Once you've edited your <code>project.yml</code> file, the next step is to install the 
project dependencies, this can be done with the <code>newt install</code> command 
(to see more output, provide the <code>-v</code> verbose option.): </p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%">$ newt install 
apache-mynewt-core
mynewt_arduino_zero
$
</pre></div>


<h3 id="create-your-bootloader-target">Create your bootloader Target<a class="headerlink" href="#create-your-bootloader-target" title="Permanent link">&para;</a></h3>
<p>Next, you need to tell Newt what to build.  For the Arduino Zero, we are going to 
generate both a bootloader, and an image target.</p>
<p>To generate the bootloader target, you need to specify the following options:</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%">$ newt target create arduino_boot 
Target targets/arduino_boot successfully created
$ newt target set arduino_boot bsp=@mynewt_arduino_zero/hw/bsp/arduino_zero 
Target targets/arduino_boot successfully set target.bsp to @mynewt_arduino_zero/hw/bsp/arduino_zero
$ newt target set arduino_boot app=@apache-mynewt-core/apps/boot 
Target targets/arduino_boot successfully set target.app to @apache-mynewt-core/apps/boot
$ newt target set arduino_boot features=arduino_zero_pro 
Target targets/arduino_boot successfully set pkg.features to arduino_zero_pro
</pre></div>


<p>These commands do a few things: </p>
<ul>
<li>Create a target named <code>arduino_boot</code>, in order to build the Arduino Zero Bootloader.</li>
<li>Set the application for the <code>arduino_boot</code> target to the default Apache Mynewt 
    bootloader (<code>@apache-mynewt-core/apps/boot</code>)</li>
<li>Set the board support package for the target to 
    <code>@mynewt_arduino_zero/hw/bsp/arduino_zero</code>.  This is a reference to the downloaded 
    Arduino Zero support from Github.</li>
<li>Tells the Board Support Package to enable support for the Arduino Zero Pro, and not 
    the Arduino Zero.  This is done through setting a build feature.  If you are building 
    for an Arduino Zero, and not a Zero Pro, this feature should be set to <code>arduino_zero</code>.</li>
</ul>
<p>Once you've configured the bootloader target, the next step is to build the bootloader for
your Arduino, you can do this by using the <code>newt build</code> command:</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%">$ newt build arduino_boot 
Compiling asprintf.c
Compiling atoi.c
Compiling atol.c
Compiling atoll.c
Compiling bsearch.c
Compiling bzero.c
Compiling calloc.c
Compiling fgets.c
Compiling inline.c
&lt;snip&gt;
App successfully built: myproject/bin/arduino_boot/apps/boot/boot.elf
</pre></div>


<p>If this command finishes successfully, you have successfully built the Arduino 
bootloader, and the next step is to build your application for the Arduino 
board.</p>
<p>To create and download your application, you create another target, this one pointing
to the application you want to download to the Arduino board.  In this tutorial, 
we will use the default application that comes with your project, <code>apps/blinky</code>:</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%">$ newt target create arduino_blinky 
Target targets/arduino_blinky successfully created
$ newt target set arduino_blinky app=apps/blinky 
Target targets/arduino_blinky successfully set target.app to apps/blinky
$ newt target set arduino_blinky bsp=@mynewt_arduino_zero/hw/bsp/arduino_zero
Target targets/arduino_blinky successfully set target.bsp to @mynewt_arduino_zero/hw/bsp/arduino_zero
$ newt target set arduino_blinky build_profile=debug 
Target targets/arduino_blinky successfully set target.build_profile to debug
$ newt target set arduino_blinky features=arduino_zero_pro 
Target targets/arduino_blinky successfully set pkg.features to arduino_zero_pro
$ 
</pre></div>


<p>You can now build the target, with <code>newt build</code>: </p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%">$ newt build arduino_blinky 
Compiling main.c
Archiving blinky.a
Compiling cons_fmt.c
Compiling cons_tty.c
Archiving full.a
Compiling case.c
Compiling suite.c
Compiling testutil.c
Archiving testutil.a
&lt;snip&gt;
App successfully built: myproject/bin/arduino_blinky/apps/blinky/blinky.elf
</pre></div>


<p>Congratulations!  You have successfully built your application, now it's 
time to load the bootloader and application onto the target.</p>
<h3 id="connect-the-target">Connect the Target<a class="headerlink" href="#connect-the-target" title="Permanent link">&para;</a></h3>
<p>Connect your computer to the Arduino Zero (from now on we'll call this the 
target) with the Micro-USB cable through the Programming Port as shown below. 
Mynewt will download and debug the target through this port. You should see a 
little green LED come on. That means the board has power.</p>
<p>No external debugger is required.  The Arduino Zero comes with an internal
debugger that can be accessed by Mynewt.</p>
<p>A image below shows the Arduino Zero Programming Port.</p>
<p><img src="https://www.arduino.cc/en/uploads/Main/Zero_Usb_Ports.jpg" alt="Drawing" style="width: 400px;"/>
<img src="http://www.arduino.org//images/products/ArduinoZeroPro-flat-org.jpg" alt="Drawing" style="width: 330px;"/></p>
<h3 id="download-the-bootloader">Download the Bootloader<a class="headerlink" href="#download-the-bootloader" title="Permanent link">&para;</a></h3>
<p>Execute the command to download the bootloader. </p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%">    <span style="color: #000000">$</span> <span style="color: #000000">newt</span> <span style="color: #000000">load</span> <span style="color: #000000">arduino_boot</span>
</pre></div>


<p>If the newt tool finishes without error, that means the bootloader has been 
successfully loaded onto the target.</p>
<h3 id="run-the-image">Run the Image<a class="headerlink" href="#run-the-image" title="Permanent link">&para;</a></h3>
<p>Now that the bootloader is downloaded to the target, the next step is to load 
your image onto the Arduino Zero.  The easiest way to do this, is to use the 
<code>newt run</code> command.  <code>newt run</code> will automatically rebuild your program
(if necessary), create an image, and load it onto the target device.</p>
<p>Here, we will load our <code>arduino_blinky</code> target onto the device, and we 
should see it run:</p>
<div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%">$ newt run arduino_blinky 0.0.0 
Debugging myproject/bin/arduino_blinky/apps/blinky/blinky.elf
Open On-Chip Debugger 0.9.0 (2015-09-23-21:46)
Licensed under GNU GPL v2
For bug reports, read
    http://openocd.org/doc/doxygen/bugs.html
Info : only one transport option; autoselect &#39;swd&#39;
adapter speed: 500 kHz
adapter_nsrst_delay: 100
cortex_m reset_config sysresetreq
Info : CMSIS-DAP: SWD  Supported
Info : CMSIS-DAP: JTAG Supported
Info : CMSIS-DAP: Interface Initialised (SWD)
Info : CMSIS-DAP: FW Version = 01.1F.0118
Info : SWCLK/TCK = 1 SWDIO/TMS = 1 TDI = 1 TDO = 1 nTRST = 0 nRESET = 1
Info : CMSIS-DAP: Interface ready
Info : clock speed 500 kHz
Info : SWD IDCODE 0x0bc11477
Info : at91samd21g18.cpu: hardware has 4 breakpoints, 2 watchpoints
GNU gdb (GNU Tools for ARM Embedded Processors) 7.8.0.20150604-cvs
Copyright (C) 2014 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type &quot;show copying&quot;
and &quot;show warranty&quot; for details.
This GDB was configured as &quot;--host=x86_64-apple-darwin10 --target=arm-none-eabi&quot;.
Type &quot;show configuration&quot; for configuration details.
For bug reporting instructions, please see:
&lt;http://www.gnu.org/software/gdb/bugs/&gt;.
Find the GDB manual and other documentation resources online at:
&lt;http://www.gnu.org/software/gdb/documentation/&gt;.
For help, type &quot;help&quot;.
Type &quot;apropos word&quot; to search for commands related to &quot;word&quot;...
Reading symbols from myproject/bin/arduino_blinky/apps/blinky/blinky.elf...done.
target state: halted
target halted due to debug-request, current mode: Thread 
xPSR: 0x21000000 pc: 0x0000030e msp: 0x20008000
Info : accepting &#39;gdb&#39; connection on tcp/3333
Info : SAMD MCU: SAMD21G18A (256KB Flash, 32KB RAM)
0x0000030e in ?? ()
(gdb) r
The &quot;remote&quot; target does not support &quot;run&quot;.  Try &quot;help target&quot; or &quot;continue&quot;.
(gdb) c
Continuing.
</pre></div>


<p><em>NOTE:</em> The 0.0.0 specified after the target name to newt run, is the version 
of the image to load.  If you are not providing remote upgrade, and are just 
developing locally, you can provide 0.0.0 for every image version.</p>
<p>If you want the image to run without the debugger connected, simply quit the 
debugger and restart the board.  The image you programmed will come and run on the 
Arduino on next boot!  </p>
<h3 id="watch-the-led-blink">Watch the LED blink<a class="headerlink" href="#watch-the-led-blink" title="Permanent link">&para;</a></h3>
<p>Congratulations! You have created a Mynewt operating system running on the 
Arduino Zero. The LED right next to the power LED should be blinking. It is toggled by one task running on the Mynewt OS.   </p>
                        
                        <div class="row">
                            
<ul class="nav nav-pills" style="margin-bottom: 10px">
    <li>
    
    <a href=../tutorials/><span class="fa fa-arrow-left"></span>  Previous: toc</a>
    
    </li>
    <li class="pull-right">
    
    <a href=../olimex/></span>Next: Blinky on Olimex  <span class="fa fa-arrow-right">
    
    </li>
</ul>
                        </div>
                        <div class="row">
                            <footer>
    <div class="row">
        <div class="col-md-12">
            
                <p class="copyright">Copyright &copy; 2015 The Apache Software Foundation, Licensed under the Apache License, Version 2.0 Apache and the Apache feather logo are trademarks of The Apache Software Foundation.<br>The Apache Software Foundation Apache Incubator</p>
            
        </div>
    </div>
    <div class="copyright-logos">
        <div class="row">
            <div class="col-xs-6 text-right">
                <img src="/img/apache-feather.png" alt="Apache" title="Apache">
            </div>
            <div class="col-xs-6 text-left">
                <img src="/img/apache-logo.png" alt="Apache Incubator" title="Apache Incubator">
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <small class="footnote">
                MyNewt is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.
            </small>
        </div>
    </div>
</footer>
                        </div>
                    </div>
                </div>
            
            
        </div>

        <script src="../../../js/jquery-1.10.2.min.js"></script>
        <script src="../../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../../js/highlight.pack.js"></script>
        <script src="../../../js/base.js"></script>
        <script src="../../../js/custom.js"></script>

    </body>
</html>