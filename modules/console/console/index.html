<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="http://mynewt.incubator.apache.org/modules/console/console/">
        <link rel="shortcut icon" href="../../../img/favicon.ico">

	<title>console overview - Apache Mynewt</title>

        <link href="../../../css/bootstrap-3.0.3.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../../css/highlight.css">
        <link href="../../../css/base.css" rel="stylesheet">
        <link href="../../../css/custom.css" rel="stylesheet">
        <link href='https://fonts.googleapis.com/css?family=Roboto:400,500,700,900,300,100' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
        <link href="../../../extra.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
            <script>
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

                ga('create', 'UA-72162311-1', 'mynewt.incubator.apache.org');
                ga('send', 'pageview');
            </script>
        
    </head>


    <body class="console overview">


        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="logo-container">
        <img src="/img/logo.svg">
    </div>
    <div class="container-fluid">
        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
                <li>
                    <a href="/documentation/">Docs</a>
                </li>
                <li>
                    <a href="/download/">Download</a>
                </li>
                <li>
                    <a href="/community/">Community</a>
                </li>
                <li>
                    <a href="/events/">Events</a>
                </li>
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                
            </ul>
        </div>
    </div>
</div>

        <div class="container-fluid">
            
                <div class="row sm-extra-padding">
                    <div class="col-md-3 bg-grey sidebar-container"><div class="bs-sidebar hidden-print" role="complementary">
    <div class="sidebar-top">
        <img class="hidden-xs hidden-sm logo-small" src="/img/logo.svg" alt="MyNewt" title="MyNewt">
        <div class="small" role="search">
            <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
                <div class="form-group">
                    <input type="text" name="q" placeholder="Search documentation" />
                    <button class="search-button" type="submit"><i class="fa fa-search"></i></button>
                </div>
            </form>
        </div>
    </div>
    <ul class="nav bs-sidenav">
      
        
      
        
      
        
      
        
      
        
      
        
          
  
  <li><a href="
  ../../../get_started/newt_concepts/
">Chapter 1 - Get Started</a>
    
  </li>

        
      
        
          
  
  <li><a href="
  ../../../get_acclimated/vocabulary/
">Chapter 2 - Get Acclimated</a>
    
  </li>

        
      
        
          
  
  <li><a href="
  ../../../newt/newt_ops/
">Chapter 3 - Newt Tool</a>
    
  </li>

        
      
        
          
  
  <li><a href="
  ../../../os/mynewt_os/
">Chapter 4 - Mynewt OS</a>
    
  </li>

        
      
        
          
  
  <li><a href="
  
  
  ./

">Chapter 5 - Modules</a>
    
      <ul class="current-toc">
          
              
  
  <li><a href="
  ./
">Console</a>
    
      <ul class="current-toc">
          
              
  
    <li class="active">
      console overview
    </li>
  

          
              
  
    <li>
      <a href="../console_add_char/">console_add_char</a>
    </li>
  

          
              
  
    <li>
      <a href="../console_blocking_mode/">console_blocking_mode</a>
    </li>
  

          
              
  
    <li>
      <a href="../console_blocking_tx/">console_blocking_tx</a>
    </li>
  

          
              
  
    <li>
      <a href="../console_init/">console_init</a>
    </li>
  

          
              
  
    <li>
      <a href="../console_printf/">console_printf</a>
    </li>
  

          
              
  
    <li>
      <a href="../console_pull_char/">console_pull_char</a>
    </li>
  

          
              
  
    <li>
      <a href="../console_pull_char_head/">console_pull_char_head</a>
    </li>
  

          
              
  
    <li>
      <a href="../console_queue_char/">console_queue_char</a>
    </li>
  

          
              
  
    <li>
      <a href="../console_read/">console_read</a>
    </li>
  

          
              
  
    <li>
      <a href="../console_rx_char/">console_rx_char</a>
    </li>
  

          
              
  
    <li>
      <a href="../console_tx_char/">console_tx_char</a>
    </li>
  

          
              
  
    <li>
      <a href="../console_write/">console_write</a>
    </li>
  

          
      </ul>
    
  </li>

          
              
  
  <li><a href="
  ../../shell/shell/
">Shell</a>
    
  </li>

          
              
  
  <li><a href="
  ../../bootloader/bootloader/
">Bootloader</a>
    
  </li>

          
              
  
    <li>
      <a href="../../filesystem/">File System Abstraction</a>
    </li>
  

          
              
  
    <li>
      <a href="../../nffs/">Newtron Flash File System</a>
    </li>
  

          
              
  
  <li><a href="
  ../../testutil/testutil/
">Test Utilities</a>
    
  </li>

          
              
  
  <li><a href="
  ../../imgmgr/imgmgr/
">Image Manager</a>
    
  </li>

          
              
  
    <li>
      <a href="../../baselibc/">Baselibc library</a>
    </li>
  

          
              
  
    <li>
      <a href="../../elua/">Embedded Lua</a>
    </li>
  

          
              
  
  <li><a href="
  ../../json/json/
">JSON</a>
    
  </li>

          
      </ul>
    
  </li>

        
      
        
          
  
  <li><a href="
  ../../../newtmgr/overview/
">Chapter 6 - Newt Manager</a>
    
  </li>

        
      
        
          
  
  <li><a href="
  ../../../packaging/dist/
">Chapter 7 - Packaging it</a>
    
  </li>

        
      
    </ul>
</div></div>
                    
                    <div class="show-sidebar-container">
                        <button class="show-sidebar">Docs Menu</button>
                    </div>
                    
                    <div class="col-md-9 documentation-viewer" role="main">
                        <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../..">Docs</a> &raquo;</li>
    
      
        
          <li>Chapter 5 - Modules &raquo;</li>
        
      
        
          <li>Console &raquo;</li>
        
      
    
    <li>console overview</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
                        
                            <h1 id="console">Console<a class="headerlink" href="#console" title="Permanent link">&para;</a></h1>
<p>The console is an operating system window where users interact with system programs of the operating system or a console application by entering text input (typically from a keyboard) and reading text output (typically on the computer terminal or monitor). The text written on the console brings some information and is a sequence of characters sent by the OS or programs running on the OS. </p>
<p>Support is currently available for console access via the serial port on the hardware board.</p>
<h2 id="description">Description<a class="headerlink" href="#description" title="Permanent link">&para;</a></h2>
<p>In the Mynewt OS, the console library comes in two versions:</p>
<ul>
<li>full - containing the full implementation</li>
<li>stub - containing stubs for the API</li>
</ul>
<p>Both of these have <code>egg.yml</code> file which states that they provide the <code>console</code> API. If an egg uses this API, it should list <code>console</code> as a requirement.
For example, the shell egg is defined by the following egg.yml file:</p>
<pre><code class="no-highlight">    egg.name: libs/shell 
    egg.vers: 0.1
    egg.deps:
        - libs/os
        - libs/util
    egg.reqs:
        - console
    egg.identities:
        - SHELL 
</code></pre>

<p>The project .yml file decides which version of the console egg should be included. 
If project requires the full console capability it lists dependency <code>libs/console/full</code> in its egg.yml file. 
On the other hand, a project may not have a physical console (e.g. a UART port to connect a terminal to) but may have a dependency on an egg that has console capability. In that case you would use a console stub. Another example would be the bootloader project where we want to keep the size of the image small. It includes the <code>libs/os</code> egg that can print out messages on a console (e.g. if there is a hard fault) and the <code>libs/util</code> egg that uses full console (but only if SHELL is present to provide a CLI). However, we do not want to use any console I/O capability in this particular bootloader project to keep the size small. We simply use the console stub instead and the egg.yml file for the project boot egg looks like the following:</p>
<pre><code class="no-highlight">    project.name: boot
    project.identities: bootloader
    project.eggs:
        - libs/os
        - libs/bootutil
        - libs/nffs
        - libs/console/stub
        - libs/util 
</code></pre>

<p>Console has 2 modes for transmit; blocking and non-blocking mode. Usually the non-blocking mode is the active one; the output buffer is drained by getting TX completion interrupts from hardware, and more data is added based on these interrupts.
Blocking mode is used when we don't want TX completion interrupts. This is used when system crashes, and we still want to output info related to that crash.</p>
<h2 id="data-structures">Data structures<a class="headerlink" href="#data-structures" title="Permanent link">&para;</a></h2>
<p>Console interaction is intrinsically composed of two unidirectional systems. The console implementation uses two ring buffers containing input (receive) and output (transmit) characters, respectively. Read and write operations on the console_ring structure are managed by labeling the read location indicator the <code>cr_tail</code> and the write location indicator the <code>cr_head</code>. The console ring length is variable and is specified as the <code>cr_size</code> member of the data structure. <code>cr_buf</code> is the pointer to the actual array of data contained.</p>
<pre><code class="no-highlight">struct console_ring {
  32     uint8_t cr_head;
  33     uint8_t cr_tail;
  34     uint8_t cr_size;
  35     uint8_t _pad;
  36     uint8_t *cr_buf;
  37 }
</code></pre>

<pre><code class="no-highlight">struct console_tty {
  40     struct console_ring ct_tx;
  41     uint8_t ct_tx_buf[CONSOLE_TX_BUF_SZ]; /* must be after console_ring */
  42     struct console_ring ct_rx;
  43     uint8_t ct_rx_buf[CONSOLE_RX_BUF_SZ]; /* must be after console_ring */
  44     console_rx_cb ct_rx_cb;     /* callback that input is ready */
  45     console_write_char ct_write_char;
  46 } console_tty
</code></pre>

<h2 id="list-of-functions">List of Functions<a class="headerlink" href="#list-of-functions" title="Permanent link">&para;</a></h2>
<p>The functions available in console are:</p>
<ul>
<li><a href="../console_add_char/">console_add_char</a></li>
<li><a href="../console_blocking_mode/">console_blocking_mode</a></li>
<li><a href="../console_blocking_tx/">console_blocking_tx</a></li>
<li><a href="../console_init/">console_init</a></li>
<li><a href="../console_printf/">console_printf</a></li>
<li><a href="../console_pull_char/">console_pull_char</a></li>
<li><a href="../console_pull_char_head/">console_pull_char_head</a></li>
<li><a href="../console_queue_char/">console_queue_char</a></li>
<li><a href="../console_read/">console_read</a></li>
<li><a href="../console_rx_char/">console_rx_char</a></li>
<li><a href="../console_tx_char/">console_tx_char</a></li>
<li><a href="../console_write/">console_write</a></li>
</ul>
                        
                    </div>
                </div>
            
            <div class="row">    
                <footer>
    <div class="row">
        <div class="col-md-12">
            
                <p class="copyright">Copyright &copy; 2015 The Apache Software Foundation, Licensed under the Apache License, Version 2.0 Apache and the Apache feather logo are trademarks of The Apache Software Foundation.<br>The Apache Software Foundation Apache Incubator</p>
            
        </div>
    </div>
    <div class="copyright-logos">
        <div class="row">
            <div class="col-xs-6 text-right">
                <img src="/img/apache-feather.png" alt="Apache" title="Apache">
            </div>
            <div class="col-xs-6 text-left">
                <img src="/img/apache-logo.png" alt="Apache Incubator" title="Apache Incubator">
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <small class="footnote">
                MyNewt is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.
            </small>
        </div>
    </div>
</footer>
            </div>
        </div>

        <script src="../../../js/jquery-1.10.2.min.js"></script>
        <script src="../../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../../js/highlight.pack.js"></script>
        <script src="../../../js/base.js"></script>
        <script src="../../../js/custom.js"></script>

    </body>
</html>